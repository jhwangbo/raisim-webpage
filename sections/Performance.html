
<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Performance &mdash; raisim 1.1.0 documentation</title>
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/tabs.css" type="text/css" />
  <link rel="stylesheet" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" type="text/css" />
  <link rel="stylesheet" href="../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" type="text/css" />
  <link rel="stylesheet" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" type="text/css" />
  <!--[if lt IE 9]>
  <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
  <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
  <script src="../_static/jquery.js"></script>
  <script src="../_static/underscore.js"></script>
  <script src="../_static/doctools.js"></script>
  <script src="../_static/js/theme.js"></script>
  <link rel="index" title="Index" href="../genindex.html" />
  <link rel="search" title="Search" href="../search.html" />
  <link rel="next" title="Change Log" href="ChangeLog.html" />
  <link rel="prev" title="Support" href="Support.html" /> 
</head>

<body class="wy-body-for-nav"> 
<div class="wy-grid-for-nav">
  <nav data-toggle="wy-nav-shift" class="wy-nav-side">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search"  style="background: White" >
          <a href="../index.html" class="icon icon-home"> raisim
            <img src="../_static/logo.png" class="logo" alt="Logo"/>
          </a>
          <div class="version">
            1.1.0
          </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>
      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Main">
        <p class="caption" role="heading"><span class="caption-text">Get started</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="License.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="Acknowledgement.html">Acknowledgement</a></li>
<li class="toctree-l1"><a class="reference internal" href="Support.html">Support</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Performance</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#raisim-custom-algorithm-for-articulated-system">RaiSim Custom Algorithm for Articulated System</a></li>
<li class="toctree-l2"><a class="reference internal" href="#what-matters-to-performance">What matters to performance</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ChangeLog.html">Change Log</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">RaiSim C++</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="Installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="ConventionsAndNotations.html">Conventions and Notations</a></li>
<li class="toctree-l1"><a class="reference internal" href="Math.html">Math Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="LoggingSystem.html">Logging System</a></li>
<li class="toctree-l1"><a class="reference internal" href="WorldSystem.html">World</a></li>
<li class="toctree-l1"><a class="reference internal" href="WorldConfigurationFile.html">RaiSim World Configuration File</a></li>
<li class="toctree-l1"><a class="reference internal" href="RaisimServer.html">Raisim Server</a></li>
<li class="toctree-l1"><a class="reference internal" href="Object.html">Objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="Contact.html">Contact and Collision</a></li>
<li class="toctree-l1"><a class="reference internal" href="MaterialSystem.html">Material System</a></li>
<li class="toctree-l1"><a class="reference internal" href="HeightMap.html">Height Map</a></li>
<li class="toctree-l1"><a class="reference internal" href="Constraints.html">Constraints</a></li>
<li class="toctree-l1"><a class="reference internal" href="RayTest.html">Ray Test</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Related Software</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="RaisimGymTorch.html">RaisimGymTorch</a></li>
<li class="toctree-l1"><a class="reference internal" href="RaiSimPy.html">RaisimPy</a></li>
<li class="toctree-l1"><a class="reference internal" href="RaisimUnity.html">RaiSim Unity</a></li>
<li class="toctree-l1"><a class="reference internal" href="RaiSimMatlab.html">RaisimMatlab Introduction</a></li>
</ul>

      </div>
    </div>
  </nav>

  <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
    <nav class="wy-nav-top" aria-label="Top"  style="background: White" >
      <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
      <a href="../index.html">raisim</a>
    </nav>

    <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Performance</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div itemprop="articleBody">
              
  <section id="performance">
<h1>Performance<a class="headerlink" href="#performance" title="Permalink to this headline">¶</a></h1>
<section id="raisim-custom-algorithm-for-articulated-system">
<h2>RaiSim Custom Algorithm for Articulated System<a class="headerlink" href="#raisim-custom-algorithm-for-articulated-system" title="Permalink to this headline">¶</a></h2>
<p>RaiSim v1.1 brings a totally new simulation scheme.
Older versions of RaiSim (and other simulators like MuJoCo according to its doc) use the following computation scheme for the articulated system forward dynamics.</p>
<ul class="simple">
<li><p>Composite Rigid Body Algorithm (CRBA)</p></li>
<li><p>Recursive Newton Euler (RNE)</p></li>
<li><p>Mass matrix inversion using Cholesky factorization.</p></li>
</ul>
<p>These algorithms are very efficient in computing the forward dynamics.
However, there is a faster alternative: Articulated Body Algorithm (ABA).
ABA skips the computation of the mass matrix and directly computes the generalized acceleration.
Consequently, it outperforms the CRBA+RNE+Cholesky (CRC) combination by a fairly big margin.</p>
<p>The computational complexity of the CRC is O(n^3), n being the degree of freedom (search for “the big O notation” in wikipedia if you don’t know what it is).
This means that the computational cost increases cubic to the degree of freedom of the system.
The computational cost of the ABA is O(n).
Therefore, the ABA is much more efficient than the CRC for high-degree-of-freedom systems.</p>
<p>However, the mass matrix and its inverse are essential in computing many contact related properties that contact solvers need.
This is why the older versions of RaiSim and other simulators use the CRC combo.
Because the ABA does not compute those properties, it was not useful in rigid body simulation.</p>
<p>RaiSim v1.1 is equipped with a family of new algorithms that compute the contact related properties at O(n).
These algorithms do not compute the mass matrix and its inverse (they have n^2 elements and there is no way to compute them at O(n)).
These properties are in fact not necessary to compute any contact related properties that the RaiSim contact solver needs.
Consequently, <strong>RaiSim (&gt;v1.1) computes the whole forward dynamics of an articulated system at O(n) including contact related properties</strong>.
We cannot share exactly what these algorithms do and what they compute.
They are not published.</p>
</section>
<section id="what-matters-to-performance">
<h2>What matters to performance<a class="headerlink" href="#what-matters-to-performance" title="Permalink to this headline">¶</a></h2>
<p>There are four major computational units in most rigid-body simulators.</p>
<ol class="arabic simple">
<li><p>Collision detection: O(n^2)</p></li>
<li><p>Forward dynamics computation: O(n)</p></li>
<li><p>Contact properties computation: O(nm)</p></li>
<li><p>Contact solver: O(???)</p></li>
</ol>
<p>n is the degree of freedom and m is the number of contact points.</p>
<p>In many robotic simulations, <strong>1</strong> is the most time-consuming part.
It is highly recommended that you only model necessary collision bodies.
Otherwise, you are not exploiting the fast rigid-body simulation pipeline in <strong>2</strong>, <strong>3</strong> and <strong>4</strong>.</p>
<p>When there is no collision, the simulation time should be roughly linear to the degree of freedom of the system.
Here is a plot showing the scaling.</p>
<a class="reference internal image-reference" href="../_images/chainSpeed.png"><img alt="Chain simulation speed" src="../_images/chainSpeed.png" style="width: 400px;" /></a>
<p>As shown above, we can simulate a 60-dof system at 114 kHz.</p>
<p>The model used above does not have a collision body.
If you have a big system like the 60-dof chain, the collision detection will take most of the time.
So it is important to model only important collision bodies.</p>
<p>The new simulation scheme is on average faster than the old scheme.
However, <strong>3</strong> in the old scheme is faster because the computation of the inverse mass matrix helps the computation of <strong>3</strong>.
Our O(n) algorithm is very close to the old scheme even without the inverse mass matrix but there is still a small gap.
Consequently, the old scheme might be faster if there are many contact points.</p>
<p>For the ANYmal robot without collision, the new scheme runs at 318 kHz.
This is faster than the old version which runs at 272 Hz.
All simulation tests were performed on a single core of 3950X, which is not excellent at single-thread performance.
The current best single-thread cpu (for RaiSim at least) is Apple’s M1.
The ANYmal simulation without contacts runs at 380 kHz on M1.</p>
<p>Linux and OSX are the best for RL and other high-speed simulation applications.
In Windows, you get less than half the performance due to the MSVC compiler.</p>
<p>The computational speed of <strong>4</strong> becomes very significant when there are more than 10 coupled contact points.
Therefore, it is important to check if there are unnecessary contact points.
The computational cost of <strong>4</strong> is highly dependent on their nature of coupling.
If they are not coupled at all, the computational cost is O(n).
If they are highly coupled, the computational cost becomes NP hard, which means that it is no longer a polynomial relationship.</p>
</section>
</section>


            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="ChangeLog.html" class="btn btn-neutral float-right" title="Change Log" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Support.html" class="btn btn-neutral float-left" title="Support" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2021, RaiSim Tech Inc.

    </p>
  </div> 

</footer>

        </div>
      </div>
  </section>
</div>
<script>
  jQuery(function () {
    SphinxRtdTheme.Navigation.enable(true);
  });
</script> 

</body>
</html>