
<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>RaisimGymTorch &mdash; raisim 1.1.6 documentation</title>
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/tabs.css" type="text/css" />
  <link rel="stylesheet" href="../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" type="text/css" />
  <link rel="stylesheet" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" type="text/css" />
  <link rel="stylesheet" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" type="text/css" />
  <!--[if lt IE 9]>
  <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
  <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
  <script src="../_static/jquery.js"></script>
  <script src="../_static/underscore.js"></script>
  <script src="../_static/doctools.js"></script>
  <script src="../_static/js/theme.js"></script>
  <link rel="index" title="Index" href="../genindex.html" />
  <link rel="search" title="Search" href="../search.html" />
  <link rel="next" title="RaisimPy" href="RaiSimPy.html" />
  <link rel="prev" title="Sensors" href="Sensors.html" /> 
</head>

<body class="wy-body-for-nav"> 
<div class="wy-grid-for-nav">
  <nav data-toggle="wy-nav-shift" class="wy-nav-side">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search"  style="background: White" >
          <a href="../index.html" class="icon icon-home"> raisim
            <img src="../_static/logo.png" class="logo" alt="Logo"/>
          </a>
          <div class="version">
            1.1.6
          </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>
      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Main">
        <p class="caption" role="heading"><span class="caption-text">Get started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="License.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="Acknowledgement.html">Acknowledgement</a></li>
<li class="toctree-l1"><a class="reference internal" href="Support.html">Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="Performance.html">Performance</a></li>
<li class="toctree-l1"><a class="reference internal" href="ChangeLog.html">Change Log</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">RaiSim C++</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="Installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Visualizers.html">Visualizers</a></li>
<li class="toctree-l1"><a class="reference internal" href="ConventionsAndNotations.html">Conventions and Notations</a></li>
<li class="toctree-l1"><a class="reference internal" href="Math.html">Math Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="LoggingSystem.html">Logging System</a></li>
<li class="toctree-l1"><a class="reference internal" href="WorldSystem.html">World</a></li>
<li class="toctree-l1"><a class="reference internal" href="WorldConfigurationFile.html">RaiSim World Configuration File</a></li>
<li class="toctree-l1"><a class="reference internal" href="RaisimServer.html">Raisim Server</a></li>
<li class="toctree-l1"><a class="reference internal" href="Object.html">Objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="Contact.html">Contact and Collision</a></li>
<li class="toctree-l1"><a class="reference internal" href="MaterialSystem.html">Material System</a></li>
<li class="toctree-l1"><a class="reference internal" href="HeightMap.html">Height Map</a></li>
<li class="toctree-l1"><a class="reference internal" href="Constraints.html">Constraints</a></li>
<li class="toctree-l1"><a class="reference internal" href="RayTest.html">Ray Test</a></li>
<li class="toctree-l1"><a class="reference internal" href="Sensors.html">Sensors</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Related Software</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">RaisimGymTorch</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#what-is-raisimgymtorch">What is raisimGymTorch?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#why-raisimgymtorch">Why raisimGymTorch?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#dependencies">Dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-to-run-the-example">How to run the example</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-to-debug">How to debug</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-does-it-work">How does it work?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-to-add-a-custom-environment">How to add a custom environment?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#code-structure-if-you-are-curious">Code structure (if you are curious)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#common-issues-and-solutions">Common issues and solutions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="RaiSimPy.html">RaisimPy</a></li>
<li class="toctree-l1"><a class="reference internal" href="RaisimUnity.html">RaiSimUnity</a></li>
<li class="toctree-l1"><a class="reference internal" href="RaisimUnreal.html">RaisimUnreal</a></li>
<li class="toctree-l1"><a class="reference internal" href="RaiSimMatlab.html">RaisimMatlab Introduction</a></li>
</ul>

      </div>
    </div>
  </nav>

  <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
    <nav class="wy-nav-top" aria-label="Top"  style="background: White" >
      <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
      <a href="../index.html">raisim</a>
    </nav>

    <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>RaisimGymTorch</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div itemprop="articleBody">
              
  <div class="section" id="raisimgymtorch">
<h1>RaisimGymTorch<a class="headerlink" href="#raisimgymtorch" title="Permalink to this headline">¶</a></h1>
<div class="section" id="what-is-raisimgymtorch">
<h2>What is raisimGymTorch?<a class="headerlink" href="#what-is-raisimgymtorch" title="Permalink to this headline">¶</a></h2>
<a class="reference internal image-reference" href="../_images/raisimGymTorch.png"><img alt="RaiSimPy demo (robots.py)" src="../_images/raisimGymTorch.png" style="width: 600px;" /></a>
<p>raisimGymTorch is a gym environment example with raisim.
A simple pytorch-based RL framework is provided as well but it should work well with any other RL frameworks.
Instead of using raisimPy, pybind11 wraps a vectorized environment in C++ so that the parallelization happens in C++.
This improves the speed tremendously.</p>
</div>
<div class="section" id="why-raisimgymtorch">
<h2>Why raisimGymTorch?<a class="headerlink" href="#why-raisimgymtorch" title="Permalink to this headline">¶</a></h2>
<p>raisimGymTorch is designed such that you can collect <strong>tens of billions of state transitions</strong> with a single desktop machine.
Such a number of state transitions is necessary to train for very difficult tasks. An example of a trained policy is shown below</p>
<img alt="trained policy 1" src="../_images/raisimGymTorch_trainedPolicy1.gif" />
<img alt="trained policy 2" src="../_images/raisimGymTorch_trainedPolicy2.gif" />
<p>About <strong>160 billion time steps</strong> were used to train the above controller.
raisimGymTorch can process about 500k time steps per second in the above environment (with 3950x) with an actuator network (which is as heavy as the physics simulation).</p>
</div>
<div class="section" id="dependencies">
<h2>Dependencies<a class="headerlink" href="#dependencies" title="Permalink to this headline">¶</a></h2>
<p>Assuming that you have installed raisim,</p>
<ul class="simple">
<li><p>Anaconda</p></li>
<li><p>pytorch (<a class="reference external" href="https://pytorch.org/">https://pytorch.org/</a>)</p></li>
<li><p>to use GPU, install cuda as well. Install the version recommended by pytorch</p></li>
<li><p>The rest of the dependencies are installed when you build a raisimGym environment for the first time</p></li>
</ul>
</div>
<div class="section" id="how-to-run-the-example">
<h2>How to run the example<a class="headerlink" href="#how-to-run-the-example" title="Permalink to this headline">¶</a></h2>
<p>We provide an ANYmal locomotion example.
In the raisimGymTorch directory,</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python setup.py develop
python raisimGymTorch/env/envs/rsg_anymal/runner.py
</pre></div>
</div>
<p>To visualize the policy, run raisimUnity as well.
It will show/record the performance of the policy every 200 iterations.
All recorded videos can be found in <code class="docutils literal notranslate"><span class="pre">raisimlib/raisimUnity/&lt;OS&gt;/screenshots</span></code></p>
</div>
<div class="section" id="how-to-debug">
<h2>How to debug<a class="headerlink" href="#how-to-debug" title="Permalink to this headline">¶</a></h2>
<p>A pybind11 package (e.g., your environment) might be difficult to debug because you have to write it in C++ but you cannot run it as a normal executable.
So we provide a debug app that wraps your environment and creates an executable.
To build the debug app, build your environment with</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python setup.py develop --Debug
</pre></div>
</div>
<p>Then, the debug executable is created next to your pybind11 package (<code class="docutils literal notranslate"><span class="pre">raisimGymTorch/raisimGymTorch/env/bin</span></code>).
If you use CLion (which is recommended), open raisimGymTorch directory in CLion.
It will automatically add the debug app executable.
It provides a convenient gui for debugging.</p>
<p>You can run the debug app as</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./debug_app_&lt;environment name&gt; &lt;full path to rsc directory&gt; &lt;full path to the cfg file&gt;
</pre></div>
</div>
<p>or add the arguments to CLion executable configuration then run.</p>
<p><strong>In Windows</strong>, make sure that you are linking against the debug-build raisim.
Visual Studio compiled executables will not work if it links against a library built with different compile flags.</p>
</div>
<div class="section" id="how-does-it-work">
<h2>How does it work?<a class="headerlink" href="#how-does-it-work" title="Permalink to this headline">¶</a></h2>
<p>RaiSimGymTorch wraps a c++ environment (i.e., ENVIRONMENT.hpp) as a python library using Pybind11.
When you call <code class="docutils literal notranslate"><span class="pre">python3</span> <span class="pre">setup.py</span> <span class="pre">develop</span></code>, all environments under <code class="docutils literal notranslate"><span class="pre">raisimGymTorch/raisimGymTorch/env/envs</span></code> are compiled.
The compiled libraries are stored in <code class="docutils literal notranslate"><span class="pre">raisimGymTorch/raisimGymTorch/env/bin</span></code>.</p>
<p>All the rest happens in Python.
You can import your environment from your python code.
For example, the anymal locomotion example can be imported as <code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">raisimGymTorch.env.bin</span> <span class="pre">import</span> <span class="pre">rsg_anymal</span></code>
Your launch file (e.g., <code class="docutils literal notranslate"><span class="pre">runner.py</span></code>) can be customized for your need.</p>
</div>
<div class="section" id="how-to-add-a-custom-environment">
<h2>How to add a custom environment?<a class="headerlink" href="#how-to-add-a-custom-environment" title="Permalink to this headline">¶</a></h2>
<p>You can copy <code class="docutils literal notranslate"><span class="pre">raisimGymTorch/raisimGymTorch</span></code> to another location.
Make sure that you delete all temporary directories <code class="docutils literal notranslate"><span class="pre">build</span></code> and <code class="docutils literal notranslate"><span class="pre">raisim_gym_torch.egg-info</span></code> (they are created when you run <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">setup.py</span> <span class="pre">develop</span></code>).
To build in another directory, you have to let cmake know where you have raisim as</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python setup.py develop --CMAKE_PREFIX_PATH &lt;WHERE-YOU-HAVE-RAISIM&gt;/raisim/&lt;OS&gt;
</pre></div>
</div>
<p>Everything will work without further operations.
However, if you want to keep multiple environments, you might want to change a few of them.</p>
<blockquote>
<div><ul class="simple">
<li><p>Package name: You can find it in <code class="docutils literal notranslate"><span class="pre">setup.py</span></code> (<code class="docutils literal notranslate"><span class="pre">name='raisim_gym_torch'</span></code>). This is the name you will find in <code class="docutils literal notranslate"><span class="pre">site_packages</span></code> directory of your anaconda environment.</p></li>
<li><p>Directory name: This is the directory name that you will find in the top <code class="docutils literal notranslate"><span class="pre">raisimGymTorch</span></code> directory. The default name is also <code class="docutils literal notranslate"><span class="pre">raisimGymTorch</span></code> directory. Modify it if necessary. Then, you have to modify the directories in the header of <code class="docutils literal notranslate"><span class="pre">runner.py</span></code> and the <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code>.</p></li>
<li><p>Binary name: This is the name of the directory of your environment. The default name is <code class="docutils literal notranslate"><span class="pre">rsg_anymal</span></code>. If you change the directory name, you have to rename <code class="docutils literal notranslate"><span class="pre">rsg_anymal</span></code> in <code class="docutils literal notranslate"><span class="pre">runner.py</span></code> file.</p></li>
<li><p>Environment name: This is the name of the binary that will be built from your <code class="docutils literal notranslate"><span class="pre">Environment.hpp</span></code> file. The default name is <code class="docutils literal notranslate"><span class="pre">RaisimGymVecEnv</span></code>. You can find it in <code class="docutils literal notranslate"><span class="pre">raisim_gym.cpp</span></code> file. If you change it, you also have to change the name is <code class="docutils literal notranslate"><span class="pre">runner.py</span></code> file.</p></li>
</ul>
<p>You can also just create another conda environment to avoid name conflicts.</p>
</div></blockquote>
</div>
<div class="section" id="code-structure-if-you-are-curious">
<h2>Code structure (if you are curious)<a class="headerlink" href="#code-structure-if-you-are-curious" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">ENVIRONMENT</span></code> class is where you define the dynamics, reward, termination condition and so on.
This class inherits from <code class="docutils literal notranslate"><span class="pre">RaisimGymEnv</span></code>, which add basic functionalities to the environment such as <code class="docutils literal notranslate"><span class="pre">setSimulationTimeStep</span></code>, <code class="docutils literal notranslate"><span class="pre">setControlTimeStep</span></code>, <code class="docutils literal notranslate"><span class="pre">getObDim</span></code> and so on.
If <code class="docutils literal notranslate"><span class="pre">RaisimGymEnv</span></code> is not general enough for you, you can also make <code class="docutils literal notranslate"><span class="pre">ENVIRONMENT</span></code> independent from <code class="docutils literal notranslate"><span class="pre">RaisimGymEnv</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">RaisimGymEnv</span></code> is wrapped by <code class="docutils literal notranslate"><span class="pre">VectorizedEnvironment</span></code>, which parallelizes the environment using openmp.
You can consider it similar to <code class="docutils literal notranslate"><span class="pre">VectorEnv</span></code> in OpenAI Baselines but RaisimGym parallelization happens in C++, which makes it orders of magnitude faster.</p>
<p><code class="docutils literal notranslate"><span class="pre">raisim_gym.cpp</span></code> is a Pybind11 wrapping of <code class="docutils literal notranslate"><span class="pre">VectorizedEnvironment</span></code>.
It simply defines the interface functions.</p>
<p>Finally, <code class="docutils literal notranslate"><span class="pre">RaisimGymVecEnv</span></code> is a python class that wraps a python library created from <code class="docutils literal notranslate"><span class="pre">raisim_gym.cpp</span></code>.</p>
</div>
<div class="section" id="common-issues-and-solutions">
<h2>Common issues and solutions<a class="headerlink" href="#common-issues-and-solutions" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>If python scripts complain about missing “libcudnn.so”: conda install -c nvidia cudnn</p></li>
</ul>
</div>
</div>


            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="RaiSimPy.html" class="btn btn-neutral float-right" title="RaisimPy" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Sensors.html" class="btn btn-neutral float-left" title="Sensors" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2022, RaiSim Tech Inc.

    </p>
  </div> 

</footer>

        </div>
      </div>
  </section>
</div>
<script>
  jQuery(function () {
    SphinxRtdTheme.Navigation.enable(true);
  });
</script> 

</body>
</html>